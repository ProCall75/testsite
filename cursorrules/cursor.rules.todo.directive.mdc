meta:
  name: "cursor.rules.todo.directive"
  version: "3.3-front"
  scope: "workflow_todo"
  owner: "Alfred.ai"

description: >
  Directive strictement sÃ©quentielle de gÃ©nÃ©ration et dâ€™exÃ©cution des To-Do dans le cadre du SystÃ¨me Alfred.
  Cette rÃ¨gle empÃªche toute anticipation, tout empiÃ¨tement inter-phases, et garantit que Cursor applique
  uniquement les tÃ¢ches explicitement autorisÃ©es dans le plan directeur macro-to-do.md.

principles:

  # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
  # ğŸ§­ SOURCE DE VÃ‰RITÃ‰
  # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
  - "La seule source de vÃ©ritÃ© pour Cursor : /@.cursor/plans/macro-to-do.md"
  - "Aucune autre rÃ©fÃ©rence ne doit piloter les To-Do."
  - "Cursor doit toujours vÃ©rifier la macro_active et la phase_active avant toute gÃ©nÃ©ration."

  # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
  # ğŸ§© GESTION DES PHASES
  # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
  - "Une macro = plusieurs phases. Une phase = une To-Do directive unique."
  - "Une seule To-Do peut exister et Ãªtre exÃ©cutÃ©e Ã  la fois."
  - "Les phases se dÃ©roulent sÃ©quentiellement et ne doivent jamais Ãªtre mÃ©langÃ©es."

  # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
  # ğŸš« INTERDITS ABSOLUS
  # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
  - "Cursor ne doit jamais anticiper une phase future."
  - "Cursor ne doit jamais revenir sur une phase passÃ©e."
  - "Cursor ne doit jamais crÃ©er de fichiers ou logique mÃ©tier qui nâ€™est pas explicitement demandÃ©."
  - "Cursor ne doit jamais implÃ©menter dâ€™UI, provider, logique mÃ©tier, navigation ou auth
     si la phase ne lâ€™autorise pas explicitement."
  - "Cursor doit refuser toute tÃ¢che non prÃ©vue dans macro-to-do.md."

workflow:

  # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
  step_1_planification:
    description: >
      GÃ©nÃ©rer la To-Do directive **uniquement** pour la phase_active.
      Cursor doit vÃ©rifier systÃ©matiquement que les tÃ¢ches proposÃ©es :
        - appartiennent strictement au pÃ©rimÃ¨tre de cette phase,
        - ne chevauchent pas de tÃ¢ches de phases suivantes,
        - ne rÃ©introduisent pas des Ã©lÃ©ments dÃ©jÃ  traitÃ©s en phases prÃ©cÃ©dentes.

    rules:
      - "NE JAMAIS produire une To-Do pour toute la macro."
      - "NE JAMAIS inclure une tÃ¢che dont l'exÃ©cution relÃ¨ve d'une macro future."
      - "TOUJOURS vÃ©rifier les dÃ©pendances inter-phases dans macro-to-do.md."
      - "TOUJOURS proposer des tÃ¢ches minimales, atomiques, et strictement structurelles."
      - "Aucune crÃ©ation de composant, provider, logique mÃ©tier ou navigation si non demandÃ©."

    format:
      - "ğŸ“‹ TODO-START Phase X"
      - "1. Action concrÃ¨te, avec chemin de fichier exact si nÃ©cessaire."
      - "2. Action suivante, strictement liÃ©e au pÃ©rimÃ¨tre de la phase."
      - "â€¦"
      - "ğŸ“‹ TODO-END Phase X"
      - "âš ï¸ Validation humaine obligatoire avant exÃ©cution."

  # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
  step_2_validation:
    description: "La validation humaine (GPT-1) est requise AVANT toute exÃ©cution."
    rules:
      - "Attendre VALIDATION HUMAINE explicite."
      - "Aucune action sans validation."
      - "Une seule To-Do active Ã  la fois."

  # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
  step_3_execution:
    description: "ExÃ©cution stricte, sÃ©quentielle, sans improvisation."
    actions:
      - "Suivre rigoureusement la numÃ©rotation."
      - "Appliquer exactement ce qui est Ã©crit."
      - "Ne rien ajouter, ne rien modifier hors To-Do."
      - "RÃ©diger un rÃ©sumÃ© 3C complet : Context / Command / Check."
      - "S'arrÃªter AVANT le commit et attendre 'OK commit'."

  # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
  step_4_commit_and_next:
    description: "Commit + nettoyage de la phase, puis passage automatique."
    actions:
      - "Commit local : â€œCommit Phase X â€” [Nom Phase]â€."
      - "Marquer '[x] Phase X terminÃ©e' dans macro-to-do.md."
      - "Remplacer intÃ©gralement la To-Do par le rÃ©sumÃ© 3C validÃ©."
      - "Activer automatiquement la phase suivante, SANS exÃ©cuter la To-Do."
      - "Attendre validation humaine pour gÃ©nÃ©rer la prochaine To-Do."

  auto_update_notepad:
    description: "Synchronisation automatique du notepad Cursor."
    command: "npm run update-phase"

  # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
  step_5_macro_completion:
    description: "ClÃ´ture propre et vÃ©rifiÃ©e."
    actions:
      - "Ajouter : 'âœ… Macro complÃ©tÃ©e â€” [Nom Macro]'"
      - "- Architecture conforme"
      - "- CohÃ©rence structurelle vÃ©rifiÃ©e"
      - "- PrÃªt pour Macro suivante"
      - "GÃ©nÃ©rer la liste des phases de la macro suivante, SANS To-Do,"
      - "Attendre validation humaine pour dÃ©marrer la nouvelle macro."

testing_and_docs:

  description: "Normes minimales de tests et de documentation."
  goals:
    - "CohÃ©rence du 3C pour chaque phase."
    - "Documentation vivante, lisible et stricte."
    - "ZÃ©ro divergence entre code exÃ©cutÃ© et plan directeur."

check:
  - "macro-to-do.md est toujours alignÃ© avec la macro_active."
  - "Aucune anticipation d'une phase future."
  - "Aucune rÃ©gression dans les phases dÃ©jÃ  complÃ©tÃ©es."
  - "Aucune crÃ©ation de fichier hors plan."
  - "RÃ©sumÃ© 3C systÃ©matique."
  - "LisibilitÃ© et cohÃ©rence vÃ©rifiÃ©es."


    rules:
      - Le `Check` DOIT respecter ce format exact :

        CHECK:
          1. PLAN_RECAP
             - Ã©tapes du plan â†’ "done / partial / skipped".

          2. ACTION_LOG
             - chronologie des actions :
               fichiers modifiÃ©s, fonctions touchÃ©es,
               type (create, refactor, bugfix, config, test).

          3. PROBLEMS_ENCOUNTERED
             - Pour chaque problÃ¨me :
               - description
               - hypothÃ¨ses
               - tentatives (1, 2, 3â€¦)
               - rÃ©sultat ("failed", "partial", "fixed", "workaround")
               - dÃ©cision finale

          4. TESTS_AND_CHECKS
             - lints, tests, vÃ©rifications manuelles + rÃ©sultats.

          5. GAPS_AND_RISKS
             - incohÃ©rences, dettes techniques,
             - points nÃ©cessitant revue humaine.

          6. ARTIFACTS
             - fichiers crÃ©Ã©s/modifiÃ©s
             - branches
             - commits locaux
             - artefacts gÃ©nÃ©rÃ©s

      - Toute variante = non-conformitÃ©.